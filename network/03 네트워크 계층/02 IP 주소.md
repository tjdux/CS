## 네트워크 주소와 호스트 주소
  - IP 주소 = 네트워크 주소 + 호스트 주소
    - 네트워크 주소
      - 네트워크를 표현하는 부분
      - 호스트가 속한 특정 네트워크를 식별하는 역할
      - 네트워크 ID, 네트워크 식별자 (network identifier) 등으로 불림
    - 호스트 주소
      - 호스트를 표현하는 부분
      - 네트워크 내에서 특정 호스트를 식별하는 역할
      - 호스트 ID, 호스트 식별자 (host identifier) 등으로 불림
  - 네트워크 주소와 호스트 주소를 구분하는 범위는 유동적일 수 있음
    - 호스트 주소 공간을 크게 할당하면 호스트가 할당되지 않은 다수의 IP 주소가 낭비될 수 있음
    - 호스트 주소 공간을 작게 할당하면 호스트가 사용할 IP 주소가 부족해질 수 있음
  - 네트워크 주소와 호스트 주소 공간의 범위 고민을 해결하기 위해 IP 주소의 클래스 개념 등장
<br/>

## 클래스풀 주소 체계 (classful addressing)
  - 클래스를 기반으로 IP 주소를 관리하는 주소 체계
    - 클래스
      - 네트워크 크기에 따라 IP 주소를 분류하는 기준
      - 필요한 호스트 IP 개수에 따라 네트워크 크기를 가변적으로 조정해 네트워크 주소와 호스트 주소 구획 가능
  - A 클래스, B 클래스, C 클래스, D 클래스, E 클래스
    - A 클래스, B 클래스, C 클래스: 네트워크의 크기를 나누는 데에 실직적으로 사용되는 클래스
    - D 클래스: 멀티캐스트를 위한 클래스
    - E 클래스: 특수한 목적을 위해 예약된 클래스
  - 1️⃣ A 클래스
    - 할당 가능한 호스트 주소의 수가 많음
    - 네트워크 주소는 첫 번째 옥텟, 호스트 주소는 나머지 3옥텟으로 구성
      - 네트워크 주소는 비트 '0'으로 시작
      - 이론상으로 $$2^7$$(128)개의 A 클래스 네트워크, 각 네트워크 별로 $$2^{24}$$(16,777,216)개의 호스트 주소 존재
    - 0.0.0.0 ~ 127.255.255.255
    - 가장 처음 옥텟 주소가 0 ~ 127
  - 2️⃣ B 클래스
    - 네트워크 주소는 2옥텟, 호스트 주소는 2옥텟으로 구성
      - 네트워크 주소는 비트 '10'으로 시작
      - 이론상으로 $$2^{14}$$(16,384)개의 B 클래스 네트워크, 각 네트워크에 속한 $$2^{16}$$(65,534)개의 호스트 주소
    - 128.0.0.0 ~ 191.255.255.255
    - 가장 처음 옥텟 주소가 128 ~ 191
  - 3️⃣ C 클래스
    - 네트워크 주소는 3옥텟, 호스트 주소는 1옥텟으로 구성
      - 네트워크 주소는 비트 '110'으로 시작
      - 이론상으로 $$2^{21}$$(2,097,152)개의 C 클래스 네트워크, 각 네트워크에는 $$2^8$$(256)개의 호스트 주소
    - 192.0.0.0 ~ 223.255.255.255
    - 가장 처음 옥텟 주소가 192 ~ 223
  - ⚠️ 호스트의 주소 공간을 모두 사용할 수 있는 것은 아님
    - 호스트 주소가 전부 0인 IP 주소: 해당 네트워크 자체를 의미하는 네트워크 주소
    - 호스트 주소가 전부 1인 IP 주소: 브로드캐스트를 위한 주소
  <table>
    <tr>
      <th>클래스</th>
      <th>초기 비트</th>
      <th>네트워크 주소 비트 / 호스트 주소 비트</th>
      <th>할당 가능한 네트워크 수</th>
      <th>할당 가능한 호스트 수</th>
    </tr>
    <tr>
      <td>A</td>
      <td>0</td>
      <td>8 / 24</td>
      <td>$$2^7$$ (128)</td>
      <td>$$2^{24}$$ (16,777,216) - 2 </td>
    </tr>
    <tr>
      <td>B</td>
      <td>10</td>
      <td>16 / 16</td>
      <td>$$2^{14}$$ (16,384)</td>
      <td>$$2^{16}$$ (65,536) - 2 </td>
    </tr>
    <tr>
      <td>C</td>
      <td>110</td>
      <td>24 / 8</td>
      <td>$$2^{21}$$ (2,097,152)</td>
      <td>$$2^8$$ (256) - 2 </td>
    </tr>
  </table>
<br/>

## 클래스리스 주소 체계 (classless addressing)
  - 클래스풀 주소 체계의 한계
    - 클래스별 네트워크의 크기가 고정되어 있기에 여전히 다수의 IP 주소가 낭비될 가능성이 큼
    - 사전에 정해진 A, B, C 클래스 외에는 다른 크기의 네트워크 구성 불가능
  - 클래스리스 주소 체계
    - 클래스풀 주소 체계보다 더 유동적이고 정교하게 네트워크 구획 가능
    - 클래스 개념 없이 (classless) 클래스에 구애 받지 않고 서브넷 마스크를 이용해 네트워크의 영역을 나누어서 호스트에게 IP 주소 공간 할당
    - 오늘날 주로 사용
  - 서브넷 마스크 (subnet mask)
    - IP 주소상에서 네트워크 주소는 1, 호스트 주소는 0으로 표기한 비트열
    - IP 주소상에서 네트워크 주소와 호스트 주소를 구분 짓는 수단
    - 네트워크 내의 부분적인 네트워크 (서브네트워크 subnetwork)를 구분 짓는 (마스크 mask) 비트열
    - 서브네팅 (subnetting): 서브넷 마스크를 이용해 클래스를 원하는 크기로 더 잘게 쪼개어 사용하는 것
  - 서브네팅: 비트 AND 연산
    - 서브넷 마스크를 이용해 네트워크 주소와 호스트 주소를 구분 짓는 방법
      - IP 주소와 서브넷 마스크를 비트 AND 연산 (네트워크 주소만 추출)
      - 비트 AND 연산: 피연산자가 모두 1인 경우에는 1, 아닌 경우에는 0이 되는 연산
    - 예제
      - IP 주소: 192.168.1.10 → 이진: 11000000.10101000.00000001.00001010
      - 서브넷 마스크: 255.255.255.0 → 이진: 11111111.11111111.11111111.00000000
      - AND 연산 결과 (네트워크 주소): 11000000.10101000.00000001.00000000 → 192.168.1.0
      - 사용된 서브넷 마스크에서 0이 8개이므로 호스트 주소는 8비트로 표현 가능
      - 실제로 할당 가능한 호스트 IP 주소: 192.168.1.1 ~ 192.168.1.254
        - 호스트 주소가 모두 0인 네트워크 주소 와 호스트 주소가 모두 1인 네트워크 주소는 제외
  - 서브넷 마스트 표기: CIDR 표기법 (Classless Inter-Domain Routing notation)
    - 'IP 주소/서브넷 마스크상의 1의 개수' 형식으로 표기
    - IP 주소 192.168.219.103과 서브넷 마스크 255.255.255.0 == 192.168.219.103/24
    - 예제
      - 192.168.0.2/25
      - IP 주소: 192.168.0.2 → 이진: 11000000.10101000.00000000.00000010
      - 서브넷 마스크: 11111111.11111111.11111111.10000000
      - AND 연산 결과 (네트워크 주소): 11000000.10101000.00000000.00000000 → 192.168.0.0
      - 사용된 서브넷 마스크에서 0이 7개이므로 호스트 주소는 7비트로 표현 가능
      - 할당 가능한 호스트 IP 주소: 192.168.0.1 ~ 192.168.0.126
        - 호스트 주소가 모두 0인 네트워크 주소 와 호스트 주소가 모두 1인 네트워크 주소는 제외
<br/>

## 공인 IP 주소와 사설 IP 주소
  - 공인 IP 주소 (public IP address)
    - 전 세계에서 고유한 IP 주소
    - 네트워크 간 통신 (e.g. 인터넷)을 이용할 때 사용
    - ISP나 공인 IP 주소 할당 기관을 통해 할당받을 수 있음
  - 사설 IP 주소 (private IP address)와 NAT (Network Address Translation)
    - 사설 IP 주소
      - 사설 네트워크에서 사용하기 위한 IP 주소
        - 사설 네트워크: 인터넷, 외부 네트워크에 공개되지 않은 네트워크
        - LAN 내의 많은 호스트는 사설 IP 주소 사용
      - 사설 IP 주소로 사용하도록 예약된 IP 주소 공간
        - 10.0.0.0/8 (10.0.0.0 - 10.255.255.255)
        - 172.16.0.0/12 (172.16.0.0 - 172.31.255.255)
        - 192.168.0.0/16 (192.168.0.0 - 192.168.255.255)
      - 사설 IP 주소 할당 주체: 라우터
      - 다른 네트워크상의 사설 IP 주소와 중복될 수 있음
    - NAT
      - 사설 IP 주소를 사용하는 호스트가 외부 네트워크와 통신하기 위해 사용되는 기술
      - IP 주소를 변환하는 기술
      - 네트워크 내부에서 사용되는 사설 IP 주소와 네트워크 내부에서 사용되는 공인 IP 주소를 변환
      - 사설 IP 주소를 사용하는 여러 호스트는 적은 수의 공인 IP 주소를 공유할 수 있음
      - 대부분의 라우터와 (가정용) 공유기에 내장
        - 사설 네트워크에서 만들어진 패킷 속 사설 IP 주소는 공유기를 거쳐 공인 IP 주소로 변경된 후 외부 네트워크로 전송
        - 외부 네트워크로부터 받은 패킷 속 공인 IP 주소는 공유기를 거쳐 사설 IP 주소로 변경된 후 사설 네트워크로 전달
      - 검색 사이트에서 내 IP 주소를 검색하면 공인 IP 주소가 조회됨 
<br/>

## 정적 IP 주소와 동적 IP 주소
  - 정적 할당
    - 호스트에 직접 수작업으로 IP 주소를 부여하는 방식
    - 정적 IP 주소 (static IP address): 정적으로 할당된 IP 주소
    - IP 주소, 서브넷 마스크, 게이트웨이(라우터) 주소, DNS 주소를 입력하여 부여
      - 기본 게이트웨이 (default gateway)
        - 게이트웨이 (gateway): 서로 다른 네트워크를 연결하는 하드웨어적 / 소프트웨어적 수단
        - 기본 게이트웨이 (default gateway)
          - 호스트가 속한 네트워크 외부로 나가기 위한 기본적인 첫 경로 (첫 번째 홉)
          - 네트워크 외부와 연결된 라우터(공유기) 주소를 의미하는 경우가 다수
  - 동적 할당과 DHCP
    - 정적 할당의 단점
      - 호스트 수가 많아질 경우 관리의 어려움
      - human error: 잘못된 IP 주소 입력, 중복된 IP 주소 입력
    - 동적 할당
      - 호스트에 IP 주소가 동적으로 할당되는 방식
      - 동적 IP 주소 (dynamic IP address)
        - 동적으로 할당된 IP 주소
        - 사용되지 않을 경우 회수되고 할당받을 때마다 다른 주소를 받을 수 있음
    - **DHCP** (Dynamic Host Configuration Protocol)
      - IP 동적 할당에 사용되는 대표적인 프로토콜
      - 응용 계층에 속함
      - IP 주소를 할당받고자 하는 호스트 (클라이언트) 와 해당 호스트에게 IP 주소를 제공하는 DHCP 서버 간에 메시지를 주고받음으로써 이루어짐
      - DHCP 서버
        - 일반적으로 라우터 (공유기)가 수행, 특정 호스트에 DHCP 서버 기능을 추가할 수 있음
        - 클라이언트에게 할당 가능한 IP 주소 목록을 관리하다가, 클라이언트가 요청할 때 IP 주소를 할당
      - **DHCP로 할당받은 IP 주소는 사용할 기간(임대 기간)이 정해져있음**
        - 일반적으로 수 시간 ~ 수 일
        - 'IP 주소를 임대한다': 임대 기간이 끝난 IP 주소는 다시 DHCP 서버로 반납
      - 클라이언트와 DHCP 서버 간에 주고받는 메시지의 종류
        - 1️⃣ DHCP Discover
          - 클라이언트 → DHCP 서버
          - DHCP 서버를 찾는 메시지
          - 브로드캐스트로 전송
          - 클라이언트는 아직 IP 주소를 할당받지 못했으므로 송신지 IP 주소는 0.0.0.0
        - 2️⃣ DHCP Offer
          - DHCP 서버 → 클라이언트
          - 클라이언트에게 할당해 줄 IP 주소를 제안하는 메시지
          - IP 주소, 서브넷 마스크, 임대 기간 등의 정보
        - 3️⃣ DHCP Request
          - 클라이언트 → DHCP 서버
          - DHCP Offer에 대한 응답
          - 브로드캐스트로 전송
        - 4️⃣ DHCP ACK
          - DHCP 서버 → 클라이언트
          - 최종 승인
          - DHCP ACK 메시지를 받은 클라이언트는 할당받은 IP 주소를 자신의 IP 주소로 설정한 뒤 임대 기간 동안 IP 주소를 사용
      - 원칙적으로 IP 주소 임대 기간이 만료되면 다시 메시지를 주고받아 IP 주소를 재할당 받아야 함
      - 임대 갱신 (lease renewal)
        - IP 주소 임대 기간이 끝나기 전에 임대 기간을 연장
        - 기본적으로 두 차례 자동으로 수행
        - 임대 갱신 과정이 모두 실패하면 IP 주소는 DHCP 서버로 반납됨

|조합|예시|
|------|---|
|공인 + 정적|기업 서버, 고정된 웹사이트 IP 등|
|공인 + 동적|일반 가정 인터넷 사용자 대부분|
|사설 + 정적|집안 프린터, NAS, 고정된 내부 장치|
|사설 + 동적|집이나 회사의 일반적인 내부 기기들 (노트북, 스마트폰 등)|
<br/>

## 예약 주소: 127.0.0.1 & 0.0.0.0 
  - 루프백 주소 (loopback address)
    - 127.0.0.0/8 (127.0.0.0 - 127.255.255.255)
    - 자기 자신을 가리키는 주소 (로컬호스트 localhost라고도 부름)
    - 127.0.0.1이 일반적
    - 자기 자신을 마치 다른 호스트인 양 간주하여 패킷을 전송
    - 주로 테스트나 디버깅 용도로 사용
  - 0.0.0.0/8
    - This host on this network
    - IP 주소를 할당받기 전에 임시로 사용하는 경우
  - 0.0.0.0/0
    - 모든 임의의 IP 주소
    - 주로 패킷이 이동할 경로를 결정하는 라우팅에서 활용
    - 디폴트 라우트를 나타내기 위해 사용
      - 디폴트 라우트 (default route): 패킷을 어떤 IP 주소로 전달할지 결정하기 어려운 경우 기본적으로 패킷을 전달할 경로 
