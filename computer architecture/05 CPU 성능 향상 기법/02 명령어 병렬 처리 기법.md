## 명령어 파이프라인
- 공장 생산 라인과 같이 명령어들을 명령어 파이프라인에 넣고 동시에 처리하는 기법 (동시에 여러 개의 명령어를 겹쳐 실행하는 기법) 
- 클럭 단위의 명령어 처리 과정
  - 1️⃣ 명령어 인출 (Instruction Fetch)
  - 2️⃣ 명령어 해석 (Instruction Decode)
  - 3️⃣ 명령어 실행 (Execute Instruction)
  - 4️⃣ 결과 저장 (Write Back)
- **같은 단계가 겹치지만 않는다면 CPU는 각 단계를 동시에 실행 가능**
- 파이프라이닝이 높은 성능을 가져오기는 하지만, 특정 상황(파이프라인 위험)에서는 성능 향상에 실패
### 파이프라인 위험
#### 데이터 위험 (data hazard) 
- *데이터 의존적*인 두 명령어를 무작정 동시에 실행하려고 하면 파이프라인이 제대로 작동하지 않음 
- 어떤 명령어는 이전 명령어를 끝까지 실행해야만 비로소 실행할 수 있음
```
명령어 1: R1 ← R2 + R3 
명령어 2: R4 ← R1 + R5
```
- 명령어 2는 명령어 1의 데이터에 의존적
#### 제어 위험 (control hazard)
- 분기 등으로 인한 프로그램 카운터의 갑작스러운 변화에 의해 발생
- 프로그램 실행 흐름이 바뀌어 명령어가 실행되면서 프로그램 카운터 값에 갑작스러운 변화가 생긴다면 예측이 틀리면 잘못 가져온 명령어들은 폐기되고, 파이프라인이 비워지는 손실 발생
- 분기 예측 (branch prediction): 프로그램이 어디로 분기할지 미리 예측한 후 그 주소를 예측하는 기술
#### 구조적 위험 (structural hazard)
- 명령어들을 겹쳐 실행하는 과정에서 서로 다른 명령어가 동시에 같은 CPU 부품을 사용하려고 할 때 발생
<br/>

## 슈퍼 스칼라
- CPU 내부에 여러 개의 명령어 파이프라인을 포함한 구조
- 슈퍼스칼라 프로세서 (CPU)
  - 매 클럭 주기마다 동시에 여러 명령어를 인출할 수도, 실행할 수도 있어야 함
  - 멀티스레드 프로세서는 슈퍼스칼라 구조 사용 가능
    - cf) 멀티스레딩은 여러 스레드 실행 / 슈퍼스칼라는 한 스레드 내에서 여러 명령어 병렬 실행
- 이론적으로는 파이프라인 개수에 비례하여 프로그램 처리 속도가 빨라짐
  - 하지만 파이프라인 위험 등의 예상치 못한 문제가 있어 실제로는 반드시 파이프라인 개수에 비례하여 빨라지지는 않음
<br/>

## 비순차적 명령어 처리 (OoOE)
- 명령어의 '합법적인 새치기'
- 명령어를 순차적으로만 실행하지 않고 순서를 바꿔 실행해도 무방한 명령어를 먼저 실행하여 명령어 파이프라인이 멈추는 것을 방지하는 기법
- 데이터 의존성이 없는 명령어를 바꿔 실행해야함
- 비순차적 명령어 처리가 가능한 CPU는 명령어들이 어떤 명령어와 데이터 의존성을 가지고 있는지, 순서를 바꿔 실행할 수 있는 명령어에는 어떤 것들이 있는지를 판단할 수 있어야 함
